#!/bin/bash
CURRENT=`date +%F-%H_%M`
CURRENTNOW=`date +%F`
LINE=`wc zoom_results.txt | awk '{print $1}'`
#pip3 install git+https://github.com/knownsec/ZoomEye-python.git
echo -e "[*] Starting at $CURRENT [*]"
echo -e "[*] Renaming old results..[*]"
mv zoom_results.txt zoom_results.old
echo -e "[*] Starting Zoomeye! [*]"
echo -e "[*] How many results? Suggested is not more than 300. Up to you.[*]"
read TH
zoomeye search 'title:"WSO2 Management Console"'  -num $TH  -filter=ip,port >> zoom_results.txt
sed -i '1d' zoom_results.txt
echo "[*] Manipulating 1 and $LINE [*]"
LINEA=`sed -i "${LINE}d" zoom_results.txt`
sed -i 's/                /:/g' zoom_results.txt
sed -i 's/:   443:/:443/g' zoom_results.txt
sed -i 's/:  443:/:443/g' zoom_results.txt
sed -i 's/: 443:/:443/g' zoom_results.txt
sed -i 's/:443:/:443/g' zoom_results.txt
sed -i 's/    443/443/g' zoom_results.txt
sed -i 's/443:/443/g' zoom_results.txt
sed -i 's/               443/:443/g' zoom_results.txt
sed -i 's/:  80:/:80/g' zoom_results.txt
sed -i 's/:   80:/:80/g' zoom_results.txt
sed -i 's/: 80:/:80/g' zoom_results.txt
sed -i 's/:80:/:80/g' zoom_results.txt
sed -i 's/80:/80/g' zoom_results.txt
sed -i 's/               80:/:80/g' zoom_results.txt
sed -i 's/               9443:/:9443/g' zoom_results.txt
sed -i 's/: 9443:/:9443/g' zoom_results.txt
sed -i 's/:  9443:/:9443/g' zoom_results.txt
sed -i 's/               9443/:9443/g' zoom_results.txt
sed -i 's/ 9443/9443/g' zoom_results.text
sed -i 's/               80/:80/g' zoom_results.txt
sed -i 's/ 9443/9443/g' zoom_results.txt
sed -i 's/  9443/9443/g' zoom_results.txt
sed -i 's/ 9443/9443/g' zoom_results.txt
LINEA=`sed -i 's/ total $TH/ /g' zoom_results.txt`
echo -e "[*] Manipulation has been completed. Results in zoom_results.txt [*]"
echo -e "[*] Want you to exploit??? [*]"
echo -e "[*] python3 exploit.py -f zoom_results.txt"
echo -e  "[*]  Done at $CURRENT [*]"
